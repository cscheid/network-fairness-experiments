<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang=""><head>
  <meta charset="utf-8">
  <meta name="generator" content="quarto-99.9.9">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>Essential Worker Community</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <script src="site_libs/quarto-nav/quarto-nav.js"></script>
  <script src="site_libs/clipboard/clipboard.min.js"></script>
  <meta name="quarto:offset" content="./">
  <script src="site_libs/quarto-search/autocomplete.umd.js"></script>
  <script src="site_libs/quarto-search/fuse.min.js"></script>
  <script src="site_libs/quarto-search/quarto-search.js"></script>
  <script src="site_libs/quarto-html/quarto.js"></script>
  <script src="site_libs/quarto-html/popper.min.js"></script>
  <script src="site_libs/quarto-html/tippy.umd.min.js"></script>
  <script src="site_libs/quarto-html/anchor.min.js"></script>
  <link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
  <link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
  <script src="site_libs/bootstrap/bootstrap.min.js"></script>
  <link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
  <link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
  <script id="quarto-search-options" type="application/json">{
    "location": "sidebar",
    "copy-button": false,
    "collapse-after": 2,
    "panel-placement": "start",
    "type": "textbox",
    "limit": 20,
    "language": {
      "search-no-results-text": "No results",
      "search-matching-documents-text": "matching documents",
      "search-copy-link-title": "Copy link to search",
      "search-hide-matches-text": "Hide additional matches",
      "search-more-match-text": "more match in this document",
      "search-more-matches-text": "more matches in this document",
      "search-clear-button-title": "Clear",
      "search-detached-cancel-button-title": "Cancel",
      "search-submit-button-title": "Submit"
    }
  }</script>
</head>
<body class="fullcontent">
<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
<!-- main -->
<main class="content">
<header id="title-block-header">
<div class="quarto-title-block"><div><h1 class="title">Essential Worker Community</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</header>
<p></p><details>
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> glob</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> exps <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_community_degrees(network, params):</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    essential <span class="op">=</span> <span class="bu">list</span>(<span class="bu">len</span>(l) <span class="cf">for</span> l <span class="kw">in</span> network[:params[<span class="st">"n1"</span>]])</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    rest <span class="op">=</span> <span class="bu">list</span>(<span class="bu">len</span>(l) <span class="cf">for</span> l <span class="kw">in</span> network[params[<span class="st">"n1"</span>] : params[<span class="st">"n1"</span>] <span class="op">+</span> params[<span class="st">"n2"</span>]])</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [essential, rest]</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_community_degrees(dists, labels, <span class="op">**</span>kwargs):</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    plt.figure()</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (dist, label) <span class="kw">in</span> <span class="bu">zip</span>(dists, labels):</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>        hist(dist, label<span class="op">=</span>label, <span class="op">**</span>kwargs)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">"Node degree"</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">"Frequency"</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> figure_1(params, xlabel):</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    c1, c2 <span class="op">=</span> split_result_by_communities(params[<span class="st">"ic_result"</span>], params)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Community means: </span><span class="sc">%s</span><span class="st">, </span><span class="sc">%s</span><span class="st">"</span> <span class="op">%</span> (numpy.mean(c1), numpy.mean(c2)))</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    hist(c1)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    hist(c2)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(xlabel)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">"Frequency"</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> delete_nodes_from_network(network, nodes_to_delete):</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    network <span class="op">=</span> read_graph(network)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    edge_list <span class="op">=</span> graph_to_edge_list(network)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># delete out-edges</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n <span class="kw">in</span> nodes_to_delete:</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>        network[n] <span class="op">=</span> []</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># delete in-edges</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    network <span class="op">=</span> <span class="bu">list</span>(<span class="bu">list</span>(e <span class="cf">for</span> e <span class="kw">in</span> l <span class="cf">if</span> e <span class="kw">not</span> <span class="kw">in</span> nodes_to_delete)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> l <span class="kw">in</span> network)</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> temp_name(<span class="st">".txt"</span>)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    write_graph(network, n)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> n</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<section id="community-model" class="level1">
<h1>2-community model</h1>
<section id="data" class="level2">
<h2 class="anchored" data-anchor-id="data">Data</h2>
<p></p><details>
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>essential <span class="op">=</span> []</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>rest <span class="op">=</span> []</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># files = glob.glob(f'../data/graphs/experiment_essential_workers_2_sbm/run_1/twocommunities_edgelist.txt')</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>files <span class="op">=</span> [ community_graph(<span class="fl">0.0001</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">1000</span>, <span class="fl">0.015</span> <span class="op">/</span> <span class="dv">2</span>, <span class="dv">1000</span>, <span class="fl">0.01</span> <span class="op">/</span> <span class="dv">2</span>) ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</section>
<section id="degree-distribution" class="level2">
<h2 class="anchored" data-anchor-id="degree-distribution">Degree distribution</h2>
<div class="cell" data-execution_count="3">
<p></p><details>
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> f <span class="kw">in</span> files:</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> read_graph(f)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    [this_essential, this_rest] <span class="op">=</span> get_community_degrees(n, {<span class="st">"n1"</span>: <span class="dv">1000</span>, <span class="st">"n2"</span>: <span class="dv">1000</span>})</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    essential.extend(this_essential)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    rest.extend(this_rest)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>plot_community_degrees(</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    [essential, rest],</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"Essential worker community"</span>, <span class="st">"Rest"</span>], <span class="bu">range</span><span class="op">=</span>(<span class="dv">0</span>, <span class="dv">27</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="fig-5_files/figure-html/cell-4-output-1.png" width="597" height="422"></p>
</div>
</div>
</section>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section">1</h2>
<div class="cell" data-execution_count="4">
<p></p><details>
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {}</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>degrees <span class="op">=</span> numpy.array(<span class="bu">list</span>(<span class="bu">len</span>(n) <span class="cf">for</span> n <span class="kw">in</span> read_graph(files[<span class="dv">0</span>])))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"thresholds"</span>] <span class="op">=</span> numpy.random.random(<span class="bu">len</span>(degrees)) <span class="op">*</span> degrees</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>nodes_to_delete <span class="op">=</span> <span class="bu">set</span>(set_seeds(<span class="bu">dict</span>(</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                n1 <span class="op">=</span> <span class="dv">1000</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>                n2 <span class="op">=</span> <span class="dv">1000</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>                seed1 <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                seed2 <span class="op">=</span> <span class="fl">0.1</span>)))</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"nodes_to_delete"</span>] <span class="op">=</span> nodes_to_delete</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"graph"</span>] <span class="op">=</span> delete_nodes_from_network(files[<span class="dv">0</span>], nodes_to_delete)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"n1"</span>] <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"n2"</span>] <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"seed1"</span>] <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"seed2"</span>] <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"seeds"</span>] <span class="op">=</span> set_seeds(params)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"alpha"</span>] <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"reprs"</span>] <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"communities"</span>] <span class="op">=</span> [<span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">1000</span>)), <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1000</span>, <span class="dv">2000</span>))]</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"ic_result"</span>] <span class="op">=</span> run_experiment(params)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>figure_1(params, <span class="st">"probability of infection"</span>)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code>Community means: 0.5505933250927071, 0.27413669064748203</code></pre>
</div>
<div class="cell-output-display">
<p><img src="fig-5_files/figure-html/cell-5-output-2.png" width="576" height="422"></p>
</div>
</div>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1">2</h2>
<div class="cell" data-execution_count="5">
<p></p><details>
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"ic_result"</span>] <span class="op">=</span> run_thresh_experiment(params)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>figure_1(params, <span class="st">"collateral harm"</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code>Community means: 0.5305933250927071, 0.3495563549160671</code></pre>
</div>
<div class="cell-output-display">
<p><img src="fig-5_files/figure-html/cell-6-output-2.png" width="576" height="422"></p>
</div>
</div>
</section>
<section id="a-sbm-based" class="level2">
<h2 class="anchored" data-anchor-id="a-sbm-based">3a, SBM-based</h2>
<div class="cell" data-execution_count="6">
<p></p><details>
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {}</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"thresholds"</span>] <span class="op">=</span> numpy.random.random(<span class="bu">len</span>(degrees)) <span class="op">*</span> degrees</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>nodes_to_delete <span class="op">=</span> <span class="bu">set</span>(set_seeds(<span class="bu">dict</span>(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                n1 <span class="op">=</span> <span class="dv">1000</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                n2 <span class="op">=</span> <span class="dv">1000</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                seed1 <span class="op">=</span> <span class="fl">0.12</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                seed2 <span class="op">=</span> <span class="fl">0.08</span>)))</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"nodes_to_delete"</span>] <span class="op">=</span> nodes_to_delete</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"graph"</span>] <span class="op">=</span> delete_nodes_from_network(files[<span class="dv">0</span>], nodes_to_delete) <span class="co"># files[0]</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"n1"</span>] <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"n2"</span>] <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"seed1"</span>] <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"seed2"</span>] <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"seeds"</span>] <span class="op">=</span> set_seeds(params)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"alpha"</span>] <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"reprs"</span>] <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"communities"</span>] <span class="op">=</span> [<span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">1000</span>)), <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1000</span>, <span class="dv">2000</span>))]</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"ic_result"</span>] <span class="op">=</span> run_experiment(params)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>figure_1(params, <span class="st">"probability of infection"</span>)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code>Community means: 0.5194223363286264, 0.2855197132616487</code></pre>
</div>
<div class="cell-output-display">
<p><img src="fig-5_files/figure-html/cell-7-output-2.png" width="576" height="422"></p>
</div>
</div>
</section>
<section id="b-degree-based" class="level2">
<h2 class="anchored" data-anchor-id="b-degree-based">3b, degree-based</h2>
<div class="cell" data-execution_count="7">
<p></p><details>
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>probs <span class="op">=</span> numpy.array(degrees)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>probs <span class="op">=</span> (probs <span class="op">/</span> probs.<span class="bu">sum</span>()) <span class="op">*</span> <span class="fl">200.0</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>nodes_to_delete <span class="op">=</span> <span class="bu">set</span>(i <span class="cf">for</span> (i, v) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">list</span>(probs)) <span class="cf">if</span> random.random() <span class="op">&lt;</span> v)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"nodes_to_delete"</span>] <span class="op">=</span> nodes_to_delete</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"graph"</span>] <span class="op">=</span> delete_nodes_from_network(files[<span class="dv">0</span>], nodes_to_delete) <span class="co"># files[0]</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"ic_result"</span>] <span class="op">=</span> run_experiment(params)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>figure_1(params, <span class="st">"probability of infection"</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code>Community means: 0.5212226512226512, 0.2705225653206651</code></pre>
</div>
<div class="cell-output-display">
<p><img src="fig-5_files/figure-html/cell-8-output-2.png" width="589" height="422"></p>
</div>
</div>
</section>
<section id="c-probability-based" class="level2">
<h2 class="anchored" data-anchor-id="c-probability-based">3c, probability-based</h2>
<div class="cell" data-execution_count="8">
<p></p><details>
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>probs <span class="op">=</span> numpy.array(degrees)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>probs <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> numpy.power(<span class="dv">1</span> <span class="op">-</span> params[<span class="st">"alpha"</span>], degrees)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>probs <span class="op">=</span> (probs <span class="op">/</span> probs.<span class="bu">sum</span>()) <span class="op">*</span> <span class="fl">200.0</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>nodes_to_delete <span class="op">=</span> <span class="bu">set</span>(i <span class="cf">for</span> (i, v) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">list</span>(probs)) <span class="cf">if</span> random.random() <span class="op">&lt;</span> v)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"nodes_to_delete"</span>] <span class="op">=</span> nodes_to_delete</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"graph"</span>] <span class="op">=</span> delete_nodes_from_network(files[<span class="dv">0</span>], nodes_to_delete) <span class="co"># files[0]</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"ic_result"</span>] <span class="op">=</span> run_experiment(params)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>figure_1(params, <span class="st">"probability of infection"</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code>Community means: 0.5480669144981413, 0.2644673123486683</code></pre>
</div>
<div class="cell-output-display">
<p><img src="fig-5_files/figure-html/cell-9-output-2.png" width="576" height="422"></p>
</div>
</div>
</section>
<section id="section-2" class="level2">
<h2 class="anchored" data-anchor-id="section-2">4</h2>
<div class="cell" data-execution_count="9">
<p></p><details>
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"ic_result"</span>] <span class="op">=</span> run_thresh_experiment(params)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>figure_1(params, <span class="st">"collateral harm"</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code>Community means: 0.5548327137546468, 0.345314769975787</code></pre>
</div>
<div class="cell-output-display">
<p><img src="fig-5_files/figure-html/cell-10-output-2.png" width="576" height="422"></p>
</div>
</div>
</section>
</section>
<section id="community-model-1" class="level1">
<h1>5-community model</h1>
<p>With this, we attempt to keep average degrees consistent across the experiments, but now there are <em>four</em> non-essential worker communities, and one essential worker community. The community sizes are 400 each.</p>
<section id="data-1" class="level2">
<h2 class="anchored" data-anchor-id="data-1">Data</h2>
<p></p><details>
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>n_communities <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_n1():</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">int</span>(<span class="dv">2000</span> <span class="op">/</span> n_communities)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>n1 <span class="op">=</span> get_n1()</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>n2 <span class="op">=</span> <span class="dv">2000</span> <span class="op">-</span> n1</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {}</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"thresholds"</span>] <span class="op">=</span> numpy.random.random(<span class="bu">len</span>(degrees)) <span class="op">*</span> degrees</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"n1"</span>] <span class="op">=</span> n1</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"n2"</span>] <span class="op">=</span> n2</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> make_many_community_graph():</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    params <span class="op">=</span> [<span class="fl">0.0001</span><span class="op">/</span><span class="dv">2</span>, n1, (<span class="fl">0.015</span> <span class="op">/</span> <span class="dv">2</span>) <span class="op">/</span> (n1 <span class="op">/</span> <span class="dv">1000</span>)]</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_communities <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>        params.extend([n1, (<span class="fl">0.01</span> <span class="op">/</span> <span class="dv">2</span>) <span class="op">/</span> (n1 <span class="op">/</span> <span class="dv">1000</span>)])</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> community_graph(<span class="op">*</span>params)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>many_comms <span class="op">=</span> make_many_community_graph()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</section>
<section id="degree-distribution-1" class="level2">
<h2 class="anchored" data-anchor-id="degree-distribution-1">Degree distribution</h2>
<div class="cell" data-execution_count="11">
<p></p><details>
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>plot_community_degrees(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    get_community_degrees(read_graph(many_comms), params),</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"Essential worker community"</span>, <span class="st">"Rest"</span>], <span class="bu">range</span><span class="op">=</span>(<span class="dv">0</span>, <span class="dv">27</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="fig-5_files/figure-html/cell-12-output-1.png" width="597" height="422"></p>
</div>
</div>
</section>
<section id="section-3" class="level2">
<h2 class="anchored" data-anchor-id="section-3">1</h2>
<div class="cell" data-execution_count="12">
<p></p><details>
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>nodes_to_delete <span class="op">=</span> <span class="bu">set</span>(set_seeds(<span class="bu">dict</span>(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                n1 <span class="op">=</span> n1,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                n2 <span class="op">=</span> n2,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                seed1 <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>                seed2 <span class="op">=</span> <span class="fl">0.1</span>)))</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"nodes_to_delete"</span>] <span class="op">=</span> nodes_to_delete</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"graph"</span>] <span class="op">=</span> delete_nodes_from_network(many_comms, nodes_to_delete)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"seed1"</span>] <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"seed2"</span>] <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"seeds"</span>] <span class="op">=</span> set_seeds(params)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"alpha"</span>] <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"reprs"</span>] <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"communities"</span>] <span class="op">=</span> [<span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">0</span>, n1)), <span class="bu">list</span>(<span class="bu">range</span>(n1, <span class="dv">2000</span>))]</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"ic_result"</span>] <span class="op">=</span> run_experiment(params)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>figure_1(params, <span class="st">"probability of infection"</span>)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code>Community means: 0.5444036697247707, 0.25209516500383733</code></pre>
</div>
<div class="cell-output-display">
<p><img src="fig-5_files/figure-html/cell-13-output-2.png" width="576" height="422"></p>
</div>
</div>
</section>
<section id="section-4" class="level2">
<h2 class="anchored" data-anchor-id="section-4">2</h2>
<div class="cell" data-execution_count="13">
<p></p><details>
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"ic_result"</span>] <span class="op">=</span> run_thresh_experiment(params)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>figure_1(params, <span class="st">"collateral harm"</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code>Community means: 0.5756880733944955, 0.29164236377590175</code></pre>
</div>
<div class="cell-output-display">
<p><img src="fig-5_files/figure-html/cell-14-output-2.png" width="585" height="422"></p>
</div>
</div>
</section>
<section id="a-sbm-based-1" class="level2">
<h2 class="anchored" data-anchor-id="a-sbm-based-1">3a, SBM-based</h2>
<p>This is not exactly comparable because since the overall sizes changed, there are now fewer essential workers, so to make vaccination rate difference match the degree difference, we need to change the parameters.</p>
<p>We arrive at <span class="math inline">\(s_1\)</span>, <span class="math inline">\(s_2\)</span> by solving the system <span class="math inline">\(s_1 = s_2 \times 1.5\)</span>, <span class="math inline">\(400 s_1 + 1600 s_2 = 200\)</span>, which gives <span class="math inline">\(s_1 \approx 0.136, s_2 \approx 0.091\)</span>.</p>
<div class="cell" data-execution_count="14">
<p></p><details>
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> solve_seeding(n1):</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    n2 <span class="op">=</span> <span class="dv">2000</span> <span class="op">-</span> n1</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># s1 = s2 * 1.5</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># n1 s1 + n2 s2 = 200</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># n1 s2 * 1.5 + n2 s2 = 200</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># n1 s2 * 1.5 + (2000 - n1) s2 = 200</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># n1 s2 * 1.5 + 2000 s2 - n1 s2 = 200</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 0.5 n1 s2 + 2000 s2 = 200</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># s2 (0.5 n1 + 2000) = 200</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># s2 = 200 / (2000 + 0.5 n1)</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">200</span> <span class="op">/</span> (<span class="dv">2000</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> n1)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"seed1: </span><span class="sc">%s</span><span class="st">, seed2: </span><span class="sc">%s</span><span class="st">"</span> <span class="op">%</span> (solve_seeding(n1) <span class="op">*</span> <span class="fl">1.5</span>, solve_seeding(n1)))</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {}</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"thresholds"</span>] <span class="op">=</span> numpy.random.random(<span class="bu">len</span>(degrees)) <span class="op">*</span> degrees</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>nodes_to_delete <span class="op">=</span> <span class="bu">set</span>(set_seeds(<span class="bu">dict</span>(</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>                n1 <span class="op">=</span> n1,</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>                n2 <span class="op">=</span> n2,</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>                seed1 <span class="op">=</span> solve_seeding(n1) <span class="op">*</span> <span class="fl">1.5</span>,</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>                seed2 <span class="op">=</span> solve_seeding(n1))))</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"nodes_to_delete"</span>] <span class="op">=</span> nodes_to_delete</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"graph"</span>] <span class="op">=</span> delete_nodes_from_network(many_comms, nodes_to_delete)</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"n1"</span>] <span class="op">=</span> n1</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"n2"</span>] <span class="op">=</span> n2</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"seed1"</span>] <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"seed2"</span>] <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"seeds"</span>] <span class="op">=</span> set_seeds(params)</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"alpha"</span>] <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"reprs"</span>] <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"communities"</span>] <span class="op">=</span> [<span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">0</span>, n1)), <span class="bu">list</span>(<span class="bu">range</span>(n1, <span class="dv">2000</span>))]</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"ic_result"</span>] <span class="op">=</span> run_experiment(params)</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>figure_1(params, <span class="st">"probability of infection"</span>)</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code>seed1: 0.13636363636363635, seed2: 0.09090909090909091</code></pre>
</div>
<div class="cell-output-stdout">
<pre><code>Community means: 0.5242993630573248, 0.25776266061980346</code></pre>
</div>
<div class="cell-output-display">
<p><img src="fig-5_files/figure-html/cell-15-output-3.png" width="576" height="422"></p>
</div>
</div>
</section>
<section id="b-degree-based-1" class="level2">
<h2 class="anchored" data-anchor-id="b-degree-based-1">3b, degree-based</h2>
<div class="cell" data-execution_count="15">
<p></p><details>
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>probs <span class="op">=</span> numpy.array(degrees)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>probs <span class="op">=</span> (probs <span class="op">/</span> probs.<span class="bu">sum</span>()) <span class="op">*</span> <span class="fl">200.0</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>nodes_to_delete <span class="op">=</span> <span class="bu">set</span>(i <span class="cf">for</span> (i, v) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">list</span>(probs)) <span class="cf">if</span> random.random() <span class="op">&lt;</span> v)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"nodes_to_delete"</span>] <span class="op">=</span> nodes_to_delete</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"graph"</span>] <span class="op">=</span> delete_nodes_from_network(many_comms, nodes_to_delete)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"ic_result"</span>] <span class="op">=</span> run_experiment(params)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>figure_1(params, <span class="st">"probability of infection"</span>)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code>Community means: 0.502358803986711, 0.25757735849056607</code></pre>
</div>
<div class="cell-output-display">
<p><img src="fig-5_files/figure-html/cell-16-output-2.png" width="589" height="422"></p>
</div>
</div>
</section>
<section id="c-probability-based-1" class="level2">
<h2 class="anchored" data-anchor-id="c-probability-based-1">3c, probability-based</h2>
<div class="cell" data-execution_count="16">
<p></p><details>
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>probs <span class="op">=</span> numpy.array(degrees)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>probs <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> numpy.power(<span class="dv">1</span> <span class="op">-</span> params[<span class="st">"alpha"</span>], degrees)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>probs <span class="op">=</span> (probs <span class="op">/</span> probs.<span class="bu">sum</span>()) <span class="op">*</span> <span class="fl">200.0</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>nodes_to_delete <span class="op">=</span> <span class="bu">set</span>(i <span class="cf">for</span> (i, v) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">list</span>(probs)) <span class="cf">if</span> random.random() <span class="op">&lt;</span> v)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"nodes_to_delete"</span>] <span class="op">=</span> nodes_to_delete</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"graph"</span>] <span class="op">=</span> delete_nodes_from_network(many_comms, nodes_to_delete)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"ic_result"</span>] <span class="op">=</span> run_experiment(params)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>figure_1(params, <span class="st">"probability of infection"</span>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code>Community means: 0.55215625, 0.2564280274181264</code></pre>
</div>
<div class="cell-output-display">
<p><img src="fig-5_files/figure-html/cell-17-output-2.png" width="576" height="423"></p>
</div>
</div>
</section>
<section id="section-5" class="level2">
<h2 class="anchored" data-anchor-id="section-5">4</h2>
<div class="cell" data-execution_count="17">
<p></p><details>
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"ic_result"</span>] <span class="op">=</span> run_thresh_experiment(params)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>figure_1(params, <span class="st">"collateral harm"</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-stdout">
<pre><code>Community means: 0.58415625, 0.2908987052551409</code></pre>
</div>
<div class="cell-output-display">
<p><img src="fig-5_files/figure-html/cell-18-output-2.png" width="585" height="422"></p>
</div>
</div>


<!-- -->
<div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title anchored" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb31" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Essential Worker Community"</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> glob</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> exps <span class="im">import</span> <span class="op">*</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_community_degrees(network, params):</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    essential <span class="op">=</span> <span class="bu">list</span>(<span class="bu">len</span>(l) <span class="cf">for</span> l <span class="kw">in</span> network[:params[<span class="st">"n1"</span>]])</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    rest <span class="op">=</span> <span class="bu">list</span>(<span class="bu">len</span>(l) <span class="cf">for</span> l <span class="kw">in</span> network[params[<span class="st">"n1"</span>] : params[<span class="st">"n1"</span>] <span class="op">+</span> params[<span class="st">"n2"</span>]])</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [essential, rest]</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_community_degrees(dists, labels, <span class="op">**</span>kwargs):</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>    plt.figure()</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (dist, label) <span class="kw">in</span> <span class="bu">zip</span>(dists, labels):</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>        hist(dist, label<span class="op">=</span>label, <span class="op">**</span>kwargs)</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">"Node degree"</span>)</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">"Frequency"</span>)</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> figure_1(params, xlabel):</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>    c1, c2 <span class="op">=</span> split_result_by_communities(params[<span class="st">"ic_result"</span>], params)</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Community means: </span><span class="sc">%s</span><span class="st">, </span><span class="sc">%s</span><span class="st">"</span> <span class="op">%</span> (numpy.mean(c1), numpy.mean(c2)))</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>    hist(c1)</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>    hist(c2)</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(xlabel)</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">"Frequency"</span>)</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> delete_nodes_from_network(network, nodes_to_delete):</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>    network <span class="op">=</span> read_graph(network)</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>    edge_list <span class="op">=</span> graph_to_edge_list(network)</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># delete out-edges</span></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n <span class="kw">in</span> nodes_to_delete:</span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>        network[n] <span class="op">=</span> []</span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># delete in-edges</span></span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>    network <span class="op">=</span> <span class="bu">list</span>(<span class="bu">list</span>(e <span class="cf">for</span> e <span class="kw">in</span> l <span class="cf">if</span> e <span class="kw">not</span> <span class="kw">in</span> nodes_to_delete)</span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> l <span class="kw">in</span> network)</span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> temp_name(<span class="st">".txt"</span>)</span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>    write_graph(network, n)</span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> n</span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a><span class="fu"># 2-community model</span></span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data</span></span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a>essential <span class="op">=</span> []</span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a>rest <span class="op">=</span> []</span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true" tabindex="-1"></a><span class="co"># files = glob.glob(f'../data/graphs/experiment_essential_workers_2_sbm/run_1/twocommunities_edgelist.txt')</span></span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true" tabindex="-1"></a>files <span class="op">=</span> [ community_graph(<span class="fl">0.0001</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">1000</span>, <span class="fl">0.015</span> <span class="op">/</span> <span class="dv">2</span>, <span class="dv">1000</span>, <span class="fl">0.01</span> <span class="op">/</span> <span class="dv">2</span>) ]</span>
<span id="cb31-60"><a href="#cb31-60" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb31-61"><a href="#cb31-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-62"><a href="#cb31-62" aria-hidden="true" tabindex="-1"></a><span class="fu">## Degree distribution</span></span>
<span id="cb31-63"><a href="#cb31-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-66"><a href="#cb31-66" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb31-67"><a href="#cb31-67" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> f <span class="kw">in</span> files:</span>
<span id="cb31-68"><a href="#cb31-68" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> read_graph(f)</span>
<span id="cb31-69"><a href="#cb31-69" aria-hidden="true" tabindex="-1"></a>    [this_essential, this_rest] <span class="op">=</span> get_community_degrees(n, {<span class="st">"n1"</span>: <span class="dv">1000</span>, <span class="st">"n2"</span>: <span class="dv">1000</span>})</span>
<span id="cb31-70"><a href="#cb31-70" aria-hidden="true" tabindex="-1"></a>    essential.extend(this_essential)</span>
<span id="cb31-71"><a href="#cb31-71" aria-hidden="true" tabindex="-1"></a>    rest.extend(this_rest)</span>
<span id="cb31-72"><a href="#cb31-72" aria-hidden="true" tabindex="-1"></a>plot_community_degrees(</span>
<span id="cb31-73"><a href="#cb31-73" aria-hidden="true" tabindex="-1"></a>    [essential, rest],</span>
<span id="cb31-74"><a href="#cb31-74" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"Essential worker community"</span>, <span class="st">"Rest"</span>], <span class="bu">range</span><span class="op">=</span>(<span class="dv">0</span>, <span class="dv">27</span>))</span>
<span id="cb31-75"><a href="#cb31-75" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb31-76"><a href="#cb31-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-77"><a href="#cb31-77" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1</span></span>
<span id="cb31-78"><a href="#cb31-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-81"><a href="#cb31-81" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb31-82"><a href="#cb31-82" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {}</span>
<span id="cb31-83"><a href="#cb31-83" aria-hidden="true" tabindex="-1"></a>degrees <span class="op">=</span> numpy.array(<span class="bu">list</span>(<span class="bu">len</span>(n) <span class="cf">for</span> n <span class="kw">in</span> read_graph(files[<span class="dv">0</span>])))</span>
<span id="cb31-84"><a href="#cb31-84" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"thresholds"</span>] <span class="op">=</span> numpy.random.random(<span class="bu">len</span>(degrees)) <span class="op">*</span> degrees</span>
<span id="cb31-85"><a href="#cb31-85" aria-hidden="true" tabindex="-1"></a>nodes_to_delete <span class="op">=</span> <span class="bu">set</span>(set_seeds(<span class="bu">dict</span>(</span>
<span id="cb31-86"><a href="#cb31-86" aria-hidden="true" tabindex="-1"></a>                n1 <span class="op">=</span> <span class="dv">1000</span>,</span>
<span id="cb31-87"><a href="#cb31-87" aria-hidden="true" tabindex="-1"></a>                n2 <span class="op">=</span> <span class="dv">1000</span>,</span>
<span id="cb31-88"><a href="#cb31-88" aria-hidden="true" tabindex="-1"></a>                seed1 <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span id="cb31-89"><a href="#cb31-89" aria-hidden="true" tabindex="-1"></a>                seed2 <span class="op">=</span> <span class="fl">0.1</span>)))</span>
<span id="cb31-90"><a href="#cb31-90" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"nodes_to_delete"</span>] <span class="op">=</span> nodes_to_delete</span>
<span id="cb31-91"><a href="#cb31-91" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"graph"</span>] <span class="op">=</span> delete_nodes_from_network(files[<span class="dv">0</span>], nodes_to_delete)</span>
<span id="cb31-92"><a href="#cb31-92" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"n1"</span>] <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb31-93"><a href="#cb31-93" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"n2"</span>] <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb31-94"><a href="#cb31-94" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"seed1"</span>] <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb31-95"><a href="#cb31-95" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"seed2"</span>] <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb31-96"><a href="#cb31-96" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"seeds"</span>] <span class="op">=</span> set_seeds(params)</span>
<span id="cb31-97"><a href="#cb31-97" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"alpha"</span>] <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb31-98"><a href="#cb31-98" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"reprs"</span>] <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb31-99"><a href="#cb31-99" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"communities"</span>] <span class="op">=</span> [<span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">1000</span>)), <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1000</span>, <span class="dv">2000</span>))]</span>
<span id="cb31-100"><a href="#cb31-100" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"ic_result"</span>] <span class="op">=</span> run_experiment(params)</span>
<span id="cb31-101"><a href="#cb31-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-102"><a href="#cb31-102" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb31-103"><a href="#cb31-103" aria-hidden="true" tabindex="-1"></a>figure_1(params, <span class="st">"probability of infection"</span>)</span>
<span id="cb31-104"><a href="#cb31-104" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb31-105"><a href="#cb31-105" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb31-106"><a href="#cb31-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-107"><a href="#cb31-107" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2</span></span>
<span id="cb31-108"><a href="#cb31-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-111"><a href="#cb31-111" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb31-112"><a href="#cb31-112" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"ic_result"</span>] <span class="op">=</span> run_thresh_experiment(params)</span>
<span id="cb31-113"><a href="#cb31-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-114"><a href="#cb31-114" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb31-115"><a href="#cb31-115" aria-hidden="true" tabindex="-1"></a>figure_1(params, <span class="st">"collateral harm"</span>)</span>
<span id="cb31-116"><a href="#cb31-116" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb31-117"><a href="#cb31-117" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb31-118"><a href="#cb31-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-119"><a href="#cb31-119" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3a, SBM-based</span></span>
<span id="cb31-120"><a href="#cb31-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-123"><a href="#cb31-123" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb31-124"><a href="#cb31-124" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {}</span>
<span id="cb31-125"><a href="#cb31-125" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"thresholds"</span>] <span class="op">=</span> numpy.random.random(<span class="bu">len</span>(degrees)) <span class="op">*</span> degrees</span>
<span id="cb31-126"><a href="#cb31-126" aria-hidden="true" tabindex="-1"></a>nodes_to_delete <span class="op">=</span> <span class="bu">set</span>(set_seeds(<span class="bu">dict</span>(</span>
<span id="cb31-127"><a href="#cb31-127" aria-hidden="true" tabindex="-1"></a>                n1 <span class="op">=</span> <span class="dv">1000</span>,</span>
<span id="cb31-128"><a href="#cb31-128" aria-hidden="true" tabindex="-1"></a>                n2 <span class="op">=</span> <span class="dv">1000</span>,</span>
<span id="cb31-129"><a href="#cb31-129" aria-hidden="true" tabindex="-1"></a>                seed1 <span class="op">=</span> <span class="fl">0.12</span>,</span>
<span id="cb31-130"><a href="#cb31-130" aria-hidden="true" tabindex="-1"></a>                seed2 <span class="op">=</span> <span class="fl">0.08</span>)))</span>
<span id="cb31-131"><a href="#cb31-131" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"nodes_to_delete"</span>] <span class="op">=</span> nodes_to_delete</span>
<span id="cb31-132"><a href="#cb31-132" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"graph"</span>] <span class="op">=</span> delete_nodes_from_network(files[<span class="dv">0</span>], nodes_to_delete) <span class="co"># files[0]</span></span>
<span id="cb31-133"><a href="#cb31-133" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"n1"</span>] <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb31-134"><a href="#cb31-134" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"n2"</span>] <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb31-135"><a href="#cb31-135" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"seed1"</span>] <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb31-136"><a href="#cb31-136" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"seed2"</span>] <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb31-137"><a href="#cb31-137" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"seeds"</span>] <span class="op">=</span> set_seeds(params)</span>
<span id="cb31-138"><a href="#cb31-138" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"alpha"</span>] <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb31-139"><a href="#cb31-139" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"reprs"</span>] <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb31-140"><a href="#cb31-140" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"communities"</span>] <span class="op">=</span> [<span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">1000</span>)), <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1000</span>, <span class="dv">2000</span>))]</span>
<span id="cb31-141"><a href="#cb31-141" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"ic_result"</span>] <span class="op">=</span> run_experiment(params)</span>
<span id="cb31-142"><a href="#cb31-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-143"><a href="#cb31-143" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb31-144"><a href="#cb31-144" aria-hidden="true" tabindex="-1"></a>figure_1(params, <span class="st">"probability of infection"</span>)</span>
<span id="cb31-145"><a href="#cb31-145" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb31-146"><a href="#cb31-146" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb31-147"><a href="#cb31-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-148"><a href="#cb31-148" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3b, degree-based</span></span>
<span id="cb31-149"><a href="#cb31-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-152"><a href="#cb31-152" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb31-153"><a href="#cb31-153" aria-hidden="true" tabindex="-1"></a>probs <span class="op">=</span> numpy.array(degrees)</span>
<span id="cb31-154"><a href="#cb31-154" aria-hidden="true" tabindex="-1"></a>probs <span class="op">=</span> (probs <span class="op">/</span> probs.<span class="bu">sum</span>()) <span class="op">*</span> <span class="fl">200.0</span></span>
<span id="cb31-155"><a href="#cb31-155" aria-hidden="true" tabindex="-1"></a>nodes_to_delete <span class="op">=</span> <span class="bu">set</span>(i <span class="cf">for</span> (i, v) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">list</span>(probs)) <span class="cf">if</span> random.random() <span class="op">&lt;</span> v)</span>
<span id="cb31-156"><a href="#cb31-156" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"nodes_to_delete"</span>] <span class="op">=</span> nodes_to_delete</span>
<span id="cb31-157"><a href="#cb31-157" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"graph"</span>] <span class="op">=</span> delete_nodes_from_network(files[<span class="dv">0</span>], nodes_to_delete) <span class="co"># files[0]</span></span>
<span id="cb31-158"><a href="#cb31-158" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"ic_result"</span>] <span class="op">=</span> run_experiment(params)</span>
<span id="cb31-159"><a href="#cb31-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-160"><a href="#cb31-160" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb31-161"><a href="#cb31-161" aria-hidden="true" tabindex="-1"></a>figure_1(params, <span class="st">"probability of infection"</span>)</span>
<span id="cb31-162"><a href="#cb31-162" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb31-163"><a href="#cb31-163" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb31-164"><a href="#cb31-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-165"><a href="#cb31-165" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3c, probability-based</span></span>
<span id="cb31-166"><a href="#cb31-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-169"><a href="#cb31-169" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb31-170"><a href="#cb31-170" aria-hidden="true" tabindex="-1"></a>probs <span class="op">=</span> numpy.array(degrees)</span>
<span id="cb31-171"><a href="#cb31-171" aria-hidden="true" tabindex="-1"></a>probs <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> numpy.power(<span class="dv">1</span> <span class="op">-</span> params[<span class="st">"alpha"</span>], degrees)</span>
<span id="cb31-172"><a href="#cb31-172" aria-hidden="true" tabindex="-1"></a>probs <span class="op">=</span> (probs <span class="op">/</span> probs.<span class="bu">sum</span>()) <span class="op">*</span> <span class="fl">200.0</span></span>
<span id="cb31-173"><a href="#cb31-173" aria-hidden="true" tabindex="-1"></a>nodes_to_delete <span class="op">=</span> <span class="bu">set</span>(i <span class="cf">for</span> (i, v) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">list</span>(probs)) <span class="cf">if</span> random.random() <span class="op">&lt;</span> v)</span>
<span id="cb31-174"><a href="#cb31-174" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"nodes_to_delete"</span>] <span class="op">=</span> nodes_to_delete</span>
<span id="cb31-175"><a href="#cb31-175" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"graph"</span>] <span class="op">=</span> delete_nodes_from_network(files[<span class="dv">0</span>], nodes_to_delete) <span class="co"># files[0]</span></span>
<span id="cb31-176"><a href="#cb31-176" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"ic_result"</span>] <span class="op">=</span> run_experiment(params)</span>
<span id="cb31-177"><a href="#cb31-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-178"><a href="#cb31-178" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb31-179"><a href="#cb31-179" aria-hidden="true" tabindex="-1"></a>figure_1(params, <span class="st">"probability of infection"</span>)</span>
<span id="cb31-180"><a href="#cb31-180" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb31-181"><a href="#cb31-181" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb31-182"><a href="#cb31-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-183"><a href="#cb31-183" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4</span></span>
<span id="cb31-184"><a href="#cb31-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-187"><a href="#cb31-187" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb31-188"><a href="#cb31-188" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"ic_result"</span>] <span class="op">=</span> run_thresh_experiment(params)</span>
<span id="cb31-189"><a href="#cb31-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-190"><a href="#cb31-190" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb31-191"><a href="#cb31-191" aria-hidden="true" tabindex="-1"></a>figure_1(params, <span class="st">"collateral harm"</span>)</span>
<span id="cb31-192"><a href="#cb31-192" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb31-193"><a href="#cb31-193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb31-194"><a href="#cb31-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-195"><a href="#cb31-195" aria-hidden="true" tabindex="-1"></a><span class="fu"># 5-community model</span></span>
<span id="cb31-196"><a href="#cb31-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-197"><a href="#cb31-197" aria-hidden="true" tabindex="-1"></a>With this, we attempt to keep average degrees consistent across the</span>
<span id="cb31-198"><a href="#cb31-198" aria-hidden="true" tabindex="-1"></a>experiments, but now there are _four_ non-essential worker</span>
<span id="cb31-199"><a href="#cb31-199" aria-hidden="true" tabindex="-1"></a>communities, and one essential worker community. The community sizes</span>
<span id="cb31-200"><a href="#cb31-200" aria-hidden="true" tabindex="-1"></a>are 400 each.</span>
<span id="cb31-201"><a href="#cb31-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-202"><a href="#cb31-202" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data</span></span>
<span id="cb31-203"><a href="#cb31-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-206"><a href="#cb31-206" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb31-207"><a href="#cb31-207" aria-hidden="true" tabindex="-1"></a>n_communities <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb31-208"><a href="#cb31-208" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_n1():</span>
<span id="cb31-209"><a href="#cb31-209" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">int</span>(<span class="dv">2000</span> <span class="op">/</span> n_communities)</span>
<span id="cb31-210"><a href="#cb31-210" aria-hidden="true" tabindex="-1"></a>n1 <span class="op">=</span> get_n1()</span>
<span id="cb31-211"><a href="#cb31-211" aria-hidden="true" tabindex="-1"></a>n2 <span class="op">=</span> <span class="dv">2000</span> <span class="op">-</span> n1</span>
<span id="cb31-212"><a href="#cb31-212" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {}</span>
<span id="cb31-213"><a href="#cb31-213" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"thresholds"</span>] <span class="op">=</span> numpy.random.random(<span class="bu">len</span>(degrees)) <span class="op">*</span> degrees</span>
<span id="cb31-214"><a href="#cb31-214" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"n1"</span>] <span class="op">=</span> n1</span>
<span id="cb31-215"><a href="#cb31-215" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"n2"</span>] <span class="op">=</span> n2</span>
<span id="cb31-216"><a href="#cb31-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-217"><a href="#cb31-217" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> make_many_community_graph():</span>
<span id="cb31-218"><a href="#cb31-218" aria-hidden="true" tabindex="-1"></a>    params <span class="op">=</span> [<span class="fl">0.0001</span><span class="op">/</span><span class="dv">2</span>, n1, (<span class="fl">0.015</span> <span class="op">/</span> <span class="dv">2</span>) <span class="op">/</span> (n1 <span class="op">/</span> <span class="dv">1000</span>)]</span>
<span id="cb31-219"><a href="#cb31-219" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_communities <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb31-220"><a href="#cb31-220" aria-hidden="true" tabindex="-1"></a>        params.extend([n1, (<span class="fl">0.01</span> <span class="op">/</span> <span class="dv">2</span>) <span class="op">/</span> (n1 <span class="op">/</span> <span class="dv">1000</span>)])</span>
<span id="cb31-221"><a href="#cb31-221" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> community_graph(<span class="op">*</span>params)</span>
<span id="cb31-222"><a href="#cb31-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-223"><a href="#cb31-223" aria-hidden="true" tabindex="-1"></a>many_comms <span class="op">=</span> make_many_community_graph()</span>
<span id="cb31-224"><a href="#cb31-224" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb31-225"><a href="#cb31-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-226"><a href="#cb31-226" aria-hidden="true" tabindex="-1"></a><span class="fu">## Degree distribution</span></span>
<span id="cb31-227"><a href="#cb31-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-230"><a href="#cb31-230" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb31-231"><a href="#cb31-231" aria-hidden="true" tabindex="-1"></a>plot_community_degrees(</span>
<span id="cb31-232"><a href="#cb31-232" aria-hidden="true" tabindex="-1"></a>    get_community_degrees(read_graph(many_comms), params),</span>
<span id="cb31-233"><a href="#cb31-233" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"Essential worker community"</span>, <span class="st">"Rest"</span>], <span class="bu">range</span><span class="op">=</span>(<span class="dv">0</span>, <span class="dv">27</span>))</span>
<span id="cb31-234"><a href="#cb31-234" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb31-235"><a href="#cb31-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-236"><a href="#cb31-236" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1</span></span>
<span id="cb31-237"><a href="#cb31-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-240"><a href="#cb31-240" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb31-241"><a href="#cb31-241" aria-hidden="true" tabindex="-1"></a>nodes_to_delete <span class="op">=</span> <span class="bu">set</span>(set_seeds(<span class="bu">dict</span>(</span>
<span id="cb31-242"><a href="#cb31-242" aria-hidden="true" tabindex="-1"></a>                n1 <span class="op">=</span> n1,</span>
<span id="cb31-243"><a href="#cb31-243" aria-hidden="true" tabindex="-1"></a>                n2 <span class="op">=</span> n2,</span>
<span id="cb31-244"><a href="#cb31-244" aria-hidden="true" tabindex="-1"></a>                seed1 <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span id="cb31-245"><a href="#cb31-245" aria-hidden="true" tabindex="-1"></a>                seed2 <span class="op">=</span> <span class="fl">0.1</span>)))</span>
<span id="cb31-246"><a href="#cb31-246" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"nodes_to_delete"</span>] <span class="op">=</span> nodes_to_delete</span>
<span id="cb31-247"><a href="#cb31-247" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"graph"</span>] <span class="op">=</span> delete_nodes_from_network(many_comms, nodes_to_delete)</span>
<span id="cb31-248"><a href="#cb31-248" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"seed1"</span>] <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb31-249"><a href="#cb31-249" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"seed2"</span>] <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb31-250"><a href="#cb31-250" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"seeds"</span>] <span class="op">=</span> set_seeds(params)</span>
<span id="cb31-251"><a href="#cb31-251" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"alpha"</span>] <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb31-252"><a href="#cb31-252" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"reprs"</span>] <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb31-253"><a href="#cb31-253" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"communities"</span>] <span class="op">=</span> [<span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">0</span>, n1)), <span class="bu">list</span>(<span class="bu">range</span>(n1, <span class="dv">2000</span>))]</span>
<span id="cb31-254"><a href="#cb31-254" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"ic_result"</span>] <span class="op">=</span> run_experiment(params)</span>
<span id="cb31-255"><a href="#cb31-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-256"><a href="#cb31-256" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb31-257"><a href="#cb31-257" aria-hidden="true" tabindex="-1"></a>figure_1(params, <span class="st">"probability of infection"</span>)</span>
<span id="cb31-258"><a href="#cb31-258" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb31-259"><a href="#cb31-259" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb31-260"><a href="#cb31-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-261"><a href="#cb31-261" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2</span></span>
<span id="cb31-262"><a href="#cb31-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-265"><a href="#cb31-265" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb31-266"><a href="#cb31-266" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"ic_result"</span>] <span class="op">=</span> run_thresh_experiment(params)</span>
<span id="cb31-267"><a href="#cb31-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-268"><a href="#cb31-268" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb31-269"><a href="#cb31-269" aria-hidden="true" tabindex="-1"></a>figure_1(params, <span class="st">"collateral harm"</span>)</span>
<span id="cb31-270"><a href="#cb31-270" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb31-271"><a href="#cb31-271" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb31-272"><a href="#cb31-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-273"><a href="#cb31-273" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3a, SBM-based</span></span>
<span id="cb31-274"><a href="#cb31-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-275"><a href="#cb31-275" aria-hidden="true" tabindex="-1"></a>This is not exactly comparable because since the overall sizes changed, there are</span>
<span id="cb31-276"><a href="#cb31-276" aria-hidden="true" tabindex="-1"></a>now fewer essential workers, so to make vaccination rate difference match the</span>
<span id="cb31-277"><a href="#cb31-277" aria-hidden="true" tabindex="-1"></a>degree difference, we need to change the parameters.</span>
<span id="cb31-278"><a href="#cb31-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-279"><a href="#cb31-279" aria-hidden="true" tabindex="-1"></a>We arrive at $s_1$, $s_2$ by solving the system $s_1 = s_2 \times 1.5$, $400 s_1 + 1600 s_2 = 200$, which gives $s_1 \approx 0.136, s_2 \approx 0.091$.</span>
<span id="cb31-280"><a href="#cb31-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-283"><a href="#cb31-283" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb31-284"><a href="#cb31-284" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> solve_seeding(n1):</span>
<span id="cb31-285"><a href="#cb31-285" aria-hidden="true" tabindex="-1"></a>    n2 <span class="op">=</span> <span class="dv">2000</span> <span class="op">-</span> n1</span>
<span id="cb31-286"><a href="#cb31-286" aria-hidden="true" tabindex="-1"></a>    <span class="co"># s1 = s2 * 1.5</span></span>
<span id="cb31-287"><a href="#cb31-287" aria-hidden="true" tabindex="-1"></a>    <span class="co"># n1 s1 + n2 s2 = 200</span></span>
<span id="cb31-288"><a href="#cb31-288" aria-hidden="true" tabindex="-1"></a>    <span class="co"># n1 s2 * 1.5 + n2 s2 = 200</span></span>
<span id="cb31-289"><a href="#cb31-289" aria-hidden="true" tabindex="-1"></a>    <span class="co"># n1 s2 * 1.5 + (2000 - n1) s2 = 200</span></span>
<span id="cb31-290"><a href="#cb31-290" aria-hidden="true" tabindex="-1"></a>    <span class="co"># n1 s2 * 1.5 + 2000 s2 - n1 s2 = 200</span></span>
<span id="cb31-291"><a href="#cb31-291" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 0.5 n1 s2 + 2000 s2 = 200</span></span>
<span id="cb31-292"><a href="#cb31-292" aria-hidden="true" tabindex="-1"></a>    <span class="co"># s2 (0.5 n1 + 2000) = 200</span></span>
<span id="cb31-293"><a href="#cb31-293" aria-hidden="true" tabindex="-1"></a>    <span class="co"># s2 = 200 / (2000 + 0.5 n1)</span></span>
<span id="cb31-294"><a href="#cb31-294" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">200</span> <span class="op">/</span> (<span class="dv">2000</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> n1)</span>
<span id="cb31-295"><a href="#cb31-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-296"><a href="#cb31-296" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"seed1: </span><span class="sc">%s</span><span class="st">, seed2: </span><span class="sc">%s</span><span class="st">"</span> <span class="op">%</span> (solve_seeding(n1) <span class="op">*</span> <span class="fl">1.5</span>, solve_seeding(n1)))</span>
<span id="cb31-297"><a href="#cb31-297" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {}</span>
<span id="cb31-298"><a href="#cb31-298" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"thresholds"</span>] <span class="op">=</span> numpy.random.random(<span class="bu">len</span>(degrees)) <span class="op">*</span> degrees</span>
<span id="cb31-299"><a href="#cb31-299" aria-hidden="true" tabindex="-1"></a>nodes_to_delete <span class="op">=</span> <span class="bu">set</span>(set_seeds(<span class="bu">dict</span>(</span>
<span id="cb31-300"><a href="#cb31-300" aria-hidden="true" tabindex="-1"></a>                n1 <span class="op">=</span> n1,</span>
<span id="cb31-301"><a href="#cb31-301" aria-hidden="true" tabindex="-1"></a>                n2 <span class="op">=</span> n2,</span>
<span id="cb31-302"><a href="#cb31-302" aria-hidden="true" tabindex="-1"></a>                seed1 <span class="op">=</span> solve_seeding(n1) <span class="op">*</span> <span class="fl">1.5</span>,</span>
<span id="cb31-303"><a href="#cb31-303" aria-hidden="true" tabindex="-1"></a>                seed2 <span class="op">=</span> solve_seeding(n1))))</span>
<span id="cb31-304"><a href="#cb31-304" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"nodes_to_delete"</span>] <span class="op">=</span> nodes_to_delete</span>
<span id="cb31-305"><a href="#cb31-305" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"graph"</span>] <span class="op">=</span> delete_nodes_from_network(many_comms, nodes_to_delete)</span>
<span id="cb31-306"><a href="#cb31-306" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"n1"</span>] <span class="op">=</span> n1</span>
<span id="cb31-307"><a href="#cb31-307" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"n2"</span>] <span class="op">=</span> n2</span>
<span id="cb31-308"><a href="#cb31-308" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"seed1"</span>] <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb31-309"><a href="#cb31-309" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"seed2"</span>] <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb31-310"><a href="#cb31-310" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"seeds"</span>] <span class="op">=</span> set_seeds(params)</span>
<span id="cb31-311"><a href="#cb31-311" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"alpha"</span>] <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb31-312"><a href="#cb31-312" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"reprs"</span>] <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb31-313"><a href="#cb31-313" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"communities"</span>] <span class="op">=</span> [<span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">0</span>, n1)), <span class="bu">list</span>(<span class="bu">range</span>(n1, <span class="dv">2000</span>))]</span>
<span id="cb31-314"><a href="#cb31-314" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"ic_result"</span>] <span class="op">=</span> run_experiment(params)</span>
<span id="cb31-315"><a href="#cb31-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-316"><a href="#cb31-316" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb31-317"><a href="#cb31-317" aria-hidden="true" tabindex="-1"></a>figure_1(params, <span class="st">"probability of infection"</span>)</span>
<span id="cb31-318"><a href="#cb31-318" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb31-319"><a href="#cb31-319" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb31-320"><a href="#cb31-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-321"><a href="#cb31-321" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3b, degree-based</span></span>
<span id="cb31-322"><a href="#cb31-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-325"><a href="#cb31-325" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb31-326"><a href="#cb31-326" aria-hidden="true" tabindex="-1"></a>probs <span class="op">=</span> numpy.array(degrees)</span>
<span id="cb31-327"><a href="#cb31-327" aria-hidden="true" tabindex="-1"></a>probs <span class="op">=</span> (probs <span class="op">/</span> probs.<span class="bu">sum</span>()) <span class="op">*</span> <span class="fl">200.0</span></span>
<span id="cb31-328"><a href="#cb31-328" aria-hidden="true" tabindex="-1"></a>nodes_to_delete <span class="op">=</span> <span class="bu">set</span>(i <span class="cf">for</span> (i, v) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">list</span>(probs)) <span class="cf">if</span> random.random() <span class="op">&lt;</span> v)</span>
<span id="cb31-329"><a href="#cb31-329" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"nodes_to_delete"</span>] <span class="op">=</span> nodes_to_delete</span>
<span id="cb31-330"><a href="#cb31-330" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"graph"</span>] <span class="op">=</span> delete_nodes_from_network(many_comms, nodes_to_delete)</span>
<span id="cb31-331"><a href="#cb31-331" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"ic_result"</span>] <span class="op">=</span> run_experiment(params)</span>
<span id="cb31-332"><a href="#cb31-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-333"><a href="#cb31-333" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb31-334"><a href="#cb31-334" aria-hidden="true" tabindex="-1"></a>figure_1(params, <span class="st">"probability of infection"</span>)</span>
<span id="cb31-335"><a href="#cb31-335" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb31-336"><a href="#cb31-336" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb31-337"><a href="#cb31-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-338"><a href="#cb31-338" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3c, probability-based</span></span>
<span id="cb31-339"><a href="#cb31-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-342"><a href="#cb31-342" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb31-343"><a href="#cb31-343" aria-hidden="true" tabindex="-1"></a>probs <span class="op">=</span> numpy.array(degrees)</span>
<span id="cb31-344"><a href="#cb31-344" aria-hidden="true" tabindex="-1"></a>probs <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> numpy.power(<span class="dv">1</span> <span class="op">-</span> params[<span class="st">"alpha"</span>], degrees)</span>
<span id="cb31-345"><a href="#cb31-345" aria-hidden="true" tabindex="-1"></a>probs <span class="op">=</span> (probs <span class="op">/</span> probs.<span class="bu">sum</span>()) <span class="op">*</span> <span class="fl">200.0</span></span>
<span id="cb31-346"><a href="#cb31-346" aria-hidden="true" tabindex="-1"></a>nodes_to_delete <span class="op">=</span> <span class="bu">set</span>(i <span class="cf">for</span> (i, v) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">list</span>(probs)) <span class="cf">if</span> random.random() <span class="op">&lt;</span> v)</span>
<span id="cb31-347"><a href="#cb31-347" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"nodes_to_delete"</span>] <span class="op">=</span> nodes_to_delete</span>
<span id="cb31-348"><a href="#cb31-348" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"graph"</span>] <span class="op">=</span> delete_nodes_from_network(many_comms, nodes_to_delete)</span>
<span id="cb31-349"><a href="#cb31-349" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"ic_result"</span>] <span class="op">=</span> run_experiment(params)</span>
<span id="cb31-350"><a href="#cb31-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-351"><a href="#cb31-351" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb31-352"><a href="#cb31-352" aria-hidden="true" tabindex="-1"></a>figure_1(params, <span class="st">"probability of infection"</span>)</span>
<span id="cb31-353"><a href="#cb31-353" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb31-354"><a href="#cb31-354" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb31-355"><a href="#cb31-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-356"><a href="#cb31-356" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4</span></span>
<span id="cb31-357"><a href="#cb31-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-360"><a href="#cb31-360" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb31-361"><a href="#cb31-361" aria-hidden="true" tabindex="-1"></a>params[<span class="st">"ic_result"</span>] <span class="op">=</span> run_thresh_experiment(params)</span>
<span id="cb31-362"><a href="#cb31-362" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-363"><a href="#cb31-363" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb31-364"><a href="#cb31-364" aria-hidden="true" tabindex="-1"></a>figure_1(params, <span class="st">"collateral harm"</span>)</span>
<span id="cb31-365"><a href="#cb31-365" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb31-366"><a href="#cb31-366" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</section>
</section>
</main> <!-- /main -->
<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    setTimeout(function() {
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->


</body></html>